<div class="p-4 max-w-5xl mx-auto">
  <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6">
    <input
      type="text"
      placeholder="Search product..."
      [ngModel]="search()"
      (ngModelChange)="onSearchChange($event)"
      class="w-full sm:max-w-md px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
    />
    <button
      class="w-full sm:w-auto px-5 py-2 rounded-md bg-blue-600 text-white font-medium hover:bg-blue-700 transition"
      (click)="openForm()"
    >
      + Add Product
    </button>
  </div>

  @if (filtered().length === 0) {
    <p class="text-center text-gray-400 italic mt-8">No products found.</p>
  } @else {
    <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
      @for (product of filtered(); track product.id) {
        <div class="bg-white border border-gray-200 rounded-xl shadow-sm p-4 flex flex-col transition hover:shadow-md">
          <img
            [src]="product.image"
            alt="{{ product.title }}"
            class="w-full h-40 object-contain mb-4 rounded"
          />
          <h2 class="text-base font-semibold text-gray-900 line-clamp-2 mb-1">{{ product.title }}</h2>
          <p class="text-sm text-gray-600 mb-2 line-clamp-3">{{ product.description }}</p>

          <div class="flex items-center justify-between mb-2">
            <span class="text-sm text-gray-800 font-medium">
              {{ product.price | currency:'USD':'symbol' }}
            </span>
            <span class="text-xs px-2 py-0.5 bg-gray-100 text-gray-600 rounded-full capitalize">
              {{ product.category }}
            </span>
          </div>

          <div class="mt-auto flex justify-end gap-2">
            <button
              class="px-3 py-1 text-sm text-blue-600 border border-blue-600 rounded hover:bg-blue-50 transition"
              (click)="openForm(product)"
            >
              Edit
            </button>
            <button
              class="px-3 py-1 text-sm text-red-600 border border-red-600 rounded hover:bg-red-50 transition"
              (click)="delete(product.id)"
            >
              Delete
            </button>
          </div>
        </div>
      }
    </div>
  }

  @if (showForm()) {
    <app-product-form [product]="selected()" (closed)="closeForm($event)" />
  }
</div>
